# ุงุณู ุณูุฑ ุงูุนูู ุงูุฐู ุณูุธูุฑ ูู ุนูุงูุฉ ุชุจููุจ Actions
name: ๐ Windows RDP with VS Code Auto-Install

# ูุชู ูุชู ุชุดุบูู ูุฐุง ุงูุณูุฑ ุงูุนูู
on:
  # ูุณูุญ ุจุชุดุบูู ุงูุณูุฑ ุงูุนูู ูุฏููุงู ูู ูุงุฌูุฉ GitHub
  workflow_dispatch:

jobs:
  rdp:
    # ุชุดุบูู ุนูู ุฃุญุฏุซ ุฅุตุฏุงุฑ ูู Windows
    runs-on: windows-latest
    
    steps:
      - name: โฌ๏ธ ูุญุต (Checkout) ุงูููุฏ
        uses: actions/checkout@v4

      - name: ๐ ุฅุนุฏุงุฏ (Ngrok) - ูุฌุจ ุฃู ูููู NGROK_AUTH_TOKEN ูู ุฃุณุฑุงุฑ ุงููุณุชูุฏุน
        uses: sarisia/actions-ngrok@v0.1.7
        with:
          # ูุฐุง ุงูุณุทุฑ ููู ููุงุชุตุงู ุนุจุฑ RDP (ุงููููุฐ ุงูุงูุชุฑุงุถู 3389)
          autoconnect: '3389'
          # ุงุณุชุฎุฏุงู ุฑูุฒ ุงููุตุงุฏูุฉ ุงููุฎุฒู ูู ุฃุณุฑุงุฑ ุงููุณุชูุฏุน
          auth_token: ${{ secrets.NGROK_AUTH_TOKEN }}

      - name: โ๏ธ ุฅุนุฏุงุฏ ูุนูููุงุช ุงุชุตุงู RDP (ุงุณู ุงููุณุชุฎุฏู ููููุฉ ุงููุฑูุฑ)
        run: |
          # ูู ุจุชุบููุฑ ูููุฉ ุงููุฑูุฑ ููุง
          $user = "RDP_User"
          $pass = "YourStrongPassword123" 

          # ุฅูุดุงุก ูุณุชุฎุฏู RDP ูุชุนููู ูููุฉ ุงููุฑูุฑ
          net user $user $pass /add
          net localgroup administrators $user /add
          
          # ุนุฑุถ ูุนูููุงุช ุงูุงุชุตุงู ูู ุณุฌูุงุช ุงูุฅุฌุฑุงุกุงุช
          Write-Host "========================================"
          Write-Host "RDP User: $user"
          Write-Host "RDP Password: $pass"
          Write-Host "========================================"
        shell: powershell
        
      - name: ๐ป ุชุซุจูุช Visual Studio Code ุชููุงุฆูุงู
        run: |
          Write-Host "ุฌุงุฑู ุชูุฒูู ูุชุซุจูุช VS Code..."
          $url = "https://update.code.visualstudio.com/latest/win32-x64-user/stable"
          $output = "$env:TEMP\VSCodeSetup.exe"
          
          # ุชูุฒูู ุงูููู ุจุงุณุชุฎุฏุงู PowerShell
          Invoke-WebRequest -Uri $url -OutFile $output
          
          # ุชุดุบูู ุงูุชุซุจูุช ุงูุตุงูุช (/VERYSILENT) ูุนุฏู ุฅุนุงุฏุฉ ุงูุชุดุบูู (/NORESTART)
          & $output /VERYSILENT /NORESTART
          Write-Host "ุชู ุชุซุจูุช VS Code ุจูุฌุงุญ!"
        shell: powershell

      - name: โธ๏ธ ุฅุจูุงุก ุงูุขูุฉ ุงูุงูุชุฑุงุถูุฉ ููุฏ ุงูุชุดุบูู (ููุฏุฉ ุชุตู ุฅูู 6 ุณุงุนุงุช)
        run: |
          Write-Host "ุงูุขูุฉ ุฌุงูุฒุฉ ููุงุชุตุงู ุนุจุฑ RDP. ุณุชุณุชูุฑ ููุฏุฉ 6 ุณุงุนุงุช ูุญุฏ ุฃูุตู."
          # ุงูุงูุชุธุงุฑ ููุฏุฉ 6 ุณุงุนุงุช ูุจู ุงูุชูุงุก ุงูู Workflow
          Start-Sleep -Seconds 21600 
        shell: powershell
